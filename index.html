<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#3b82f6">
    <title>Prompt Images - Gestionnaire de Prompts IA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="mobile-styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <h1><i class="fas fa-robot"></i> Prompt Images</h1>
        <button class="theme-toggle" id="themeToggle" title="Changer le thème">
            <i class="fas fa-moon"></i>
        </button>
    </header>

    <!-- Barre de recherche -->
    <div class="search-container">
        <div class="search-wrapper">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-bar" id="searchBar" 
                   placeholder="Rechercher dans les prompts, tags, catégories...">
        </div>
    </div>

    <!-- Barre d'actions -->
    <div class="actions-bar">
        <button class="btn btn-primary" onclick="showPromptModal()">
            <i class="fas fa-plus"></i> Nouveau
        </button>
        <button class="btn btn-secondary" onclick="loadExamples()">
            <i class="fas fa-download"></i> Exemples
        </button>
        <button class="btn btn-secondary" onclick="importPrompts()">
            <i class="fas fa-file-import"></i> Importer
        </button>
        <button class="btn btn-secondary" onclick="exportPrompts()">
            <i class="fas fa-file-export"></i> Exporter
        </button>
        <button class="btn btn-secondary" onclick="checkDuplicates()">
            <i class="fas fa-search-plus"></i> Doublons
        </button>
    </div>

    <!-- Container principal -->
    <main class="container">
        <!-- Filtres de catégories -->
        <div class="category-filters" id="categoryFilters">
            <button class="category-filter active" data-category="all">
                <i class="fas fa-th"></i> Tout
            </button>
            <!-- Les catégories seront ajoutées dynamiquement -->
        </div>

        <!-- Grille de prompts -->
        <div class="prompts-grid" id="promptsGrid">
            <!-- Les cartes seront ajoutées dynamiquement -->
        </div>

        <!-- État vide -->
        <div class="empty-state" id="emptyState" style="display: none;">
            <i class="fas fa-inbox"></i>
            <h3>Aucun prompt</h3>
            <p>Commencez par créer votre premier prompt ou chargez des exemples</p>
            <button class="btn btn-primary" onclick="showPromptModal()">
                <i class="fas fa-plus"></i> Créer un prompt
            </button>
            <button class="btn btn-secondary" onclick="loadExamples()">
                <i class="fas fa-download"></i> Charger des exemples
            </button>
        </div>
    </main>

    <!-- FAB (Floating Action Buttons) -->
    <div class="fab-container">
        <button class="fab fab-secondary" onclick="scrollToTop()" id="scrollTopBtn" style="display: none;">
            <i class="fas fa-arrow-up"></i>
        </button>
        <button class="fab fab-secondary" onclick="toggleSearch()">
            <i class="fas fa-search"></i>
        </button>
        <button class="fab" onclick="showPromptModal()">
            <i class="fas fa-plus"></i>
        </button>
    </div>

    <!-- Modal de création/édition -->
    <div class="modal" id="promptModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Nouveau Prompt</h2>
                <button class="close-btn" onclick="closeModal('promptModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form id="promptForm">
                    <input type="hidden" id="promptId">
                    
                    <div class="form-group">
                        <label for="title">Titre *</label>
                        <input type="text" id="title" name="title" required 
                               placeholder="Ex: Portrait cyberpunk">
                        <div class="duplicate-warning" id="duplicateWarning" style="display: none;">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Un prompt similaire existe déjà</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="category">Catégorie</label>
                        <div class="category-input-group">
                            <select id="category" name="category">
                                <option value="">Sélectionner...</option>
                                <option value="Flux">Flux</option>
                                <option value="Krea">Krea</option>
                                <option value="Portraits">Portraits</option>
                                <option value="Paysages">Paysages</option>
                                <option value="Concept Art">Concept Art</option>
                                <option value="Réaliste">Réaliste</option>
                                <option value="Artistique">Artistique</option>
                                <option value="Autre">Autre</option>
                            </select>
                            <button type="button" class="btn btn-secondary" onclick="showCategoryModal()">
                                <i class="fas fa-folder-plus"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="replicateLink">Lien Replicate</label>
                        <input type="url" id="replicateLink" name="replicateLink" 
                               placeholder="https://replicate.com/...">
                    </div>
                    
                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" name="description" rows="2" 
                                  placeholder="Description courte (optionnel)"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="prompt">Prompt *</label>
                        <textarea id="prompt" name="prompt" rows="4" required 
                                  placeholder="Entrez votre prompt ici..."></textarea>
                        <button type="button" class="btn btn-secondary btn-sm" onclick="copyToClipboard('prompt')">
                            <i class="fas fa-copy"></i> Copier
                        </button>
                    </div>
                    
                    <div class="form-group">
                        <label for="comment">Commentaire / Notes</label>
                        <textarea id="comment" name="comment" rows="3" 
                                  placeholder="Notes personnelles, paramètres utilisés..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="json">Configuration JSON</label>
                        <div class="json-input-group">
                            <select id="jsonTemplate" onchange="applyJsonTemplate()">
                                <option value="">Sélectionner un modèle...</option>
                                <option value="flux-dev">Flux Dev</option>
                                <option value="flux-schnell">Flux Schnell</option>
                                <option value="stable-diffusion">Stable Diffusion</option>
                                <option value="dalle">DALL-E</option>
                                <option value="midjourney">Midjourney</option>
                                <option value="krea">Krea AI</option>
                                <option value="leonardo">Leonardo AI</option>
                                <option value="playground">Playground AI</option>
                                <option value="custom">Personnalisé</option>
                            </select>
                        </div>
                        <textarea id="json" name="json" rows="6" 
                                  placeholder='{"model": "flux-dev", "steps": 20, ...}'></textarea>
                        <div class="json-validation" id="jsonValidation"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="tags">Tags</label>
                        <input type="text" id="tags" name="tags" 
                               placeholder="tag1, tag2, tag3 (séparés par des virgules)">
                        <div class="tag-suggestions" id="tagSuggestions"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Images</label>
                        <div class="image-upload-zone" id="imageUploadZone">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Glissez des images ici ou cliquez pour sélectionner</p>
                            <input type="file" id="imageInput" accept="image/*" multiple style="display: none;">
                        </div>
                        <div class="images-preview" id="imagesPreview"></div>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('promptModal')">
                    Annuler
                </button>
                <button type="submit" form="promptForm" class="btn btn-primary">
                    <i class="fas fa-save"></i> Enregistrer
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de détails du prompt -->
    <div class="modal" id="promptDetailsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="detailsTitle">Détails du Prompt</h2>
                <button class="close-btn" onclick="closeModal('promptDetailsModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body" id="promptDetailsContent">
                <!-- Le contenu sera généré dynamiquement -->
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" id="copyPromptBtn">
                    <i class="fas fa-copy"></i> Copier
                </button>
                <button class="btn btn-primary" id="editPromptBtn">
                    <i class="fas fa-edit"></i> Modifier
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de gestion des catégories -->
    <div class="modal" id="categoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Gestion des Catégories</h2>
                <button class="close-btn" onclick="closeModal('categoryModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="form-group">
                    <label>Nouvelle catégorie</label>
                    <div class="category-input-group">
                        <input type="text" id="newCategoryName" placeholder="Nom de la catégorie">
                        <input type="text" id="newCategoryIcon" placeholder="fa-icon" value="fa-folder">
                        <button class="btn btn-primary" onclick="addCategory()">
                            <i class="fas fa-plus"></i> Ajouter
                        </button>
                    </div>
                </div>
                
                <div class="categories-list" id="categoriesList">
                    <!-- Liste des catégories générée dynamiquement -->
                </div>
            </div>
        </div>
    </div>

    <!-- Input caché pour l'import -->
    <input type="file" id="importInput" accept=".json" style="display: none;">

    <!-- Scripts -->
    <script src="app.js"></script>
    <script src="mobile-utils.js"></script>
    <script>
        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            loadPrompts();
            initializeApp();
            
            // Gestion du scroll pour afficher/masquer le bouton scroll to top
            window.addEventListener('scroll', function() {
                const scrollBtn = document.getElementById('scrollTopBtn');
                if (window.scrollY > 300) {
                    scrollBtn.style.display = 'flex';
                } else {
                    scrollBtn.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
